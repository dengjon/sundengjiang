# 变量

**使用注意事项**

1. 变量表示内存中的一个存储区域，不同的变量，数据类型不同，占用的空间大小就不同，例如：`int`为4个字节，`double`为8个字节
2. 变量必须<u>先声明，后使用</u>（与Python不同）
3. 变量的数据/值可以在**同一类型范围内**变化

## 数据类型

### 基本数据类型

1. 数值型 

   1. 整数类型：byte[1], short[2], int[4], long[8]

      **数值范围**：

      1. `byte `[字节]: -128 ~ 127
      2. `short` [短整型]: -32768 ~ 32767
      3. `int` [整型]: $-2^{31}$ ~ $2^{31}-1$
      4. `long` [长整型]: $-2^{63}$ ~ $2^{63}-1$

      **整数类型型使用细节**

      1. Java整数类型有固定的数值范围，不受操作系统的影响，从而保证可移植性

      2. Java的整型常量（具体值）默认为`int`类型，声明`long`类型常量需要在后面加上'l'或'L'，使用方式如下所示：

         ```java
         int a = 100L; // 报错，类型冲突
         long a = 100L; // 正确
         ```

   2. 浮点数（小数）类型：float[4], double[8]

      浮点数 = 符号位 + 指数位 + 尾数位，尾数部分可能丢失，从而造成精度损失（所有的小数都是近似值）

      **使用细节**

      1. Java的浮点型常量默认为`double`型，声明`float`型常量，需要在后面加上'f'或者'F'
      2. 由于`double`类型精度更高，因此通常情况下应当使用`double`
      3. 不要对两个小数（特别是运算过的小数）进行相等判断，比如2.7和8.1/3数值接近但不相等

2. 字符型：char[2]

   字符类型可以表示单个字符，可以存放英文和汉字，多个字符使用字符串String来存放。

   **使用细节**

   1. 字符类型可以直接存放一个数字，会输出该数字在unicode码中对应的字符
   2. 字符常量是用**单引号**括起来的单个字符，不能使用双引号
   3. 可以使用转义字符
   4. 在Java中，字符类型的本质是一个整数，可以用`int`对字符变量做类型转换，获得字符的unicode编码
   5. char类型可以进行运算，例如`'a' + 10`，因为它都有unicode码

3. 布尔型：boolean[1]，存放true, false

   注意：在Java中不可以用0和非0的整数来替代false和true，和C语言不同

> (其中[*]表示某数据类型占字节数)

### 引用数据类型

1. 类（class）
2. 接口（interface）
3. 数组（[]）

## 基本数据类型转换

### 自动类型转换

当Java程序在进行赋值或者运算时，精度小的类型可以自动转换为精度大的数据类型。数据类型按照精度（容量）大小排序为：

- char -> int -> long -> float -> double 

- byte -> short -> int -> long -> float -> double

**注意和细节**

1. 有多种类型的数据进行混合运算时，系统首先自动将所有的数据转换成**容量最大**的数据类型，再进行计算
2. 如果把精度（容量）大的数据类型赋值给精度（容量）小的数据类型，就会报错
3. （`byte`, `short`）和`char`之间不会相互自动转换
4. `byte`, `short`, `char` 三者之间可以计算，在计算时首先转换成`int`类型
5. `boolean`不参与转换

### 强制类型转换

自动类型转换的逆过程，将精度（容量）大的数据类型转换成精度（容量）小的数据类型。使用时要加上强制转换符`( )`，<u>可能造成精度降低或者溢出</u>。例如：

```java
int n1 = (int)1.9; // output: 1，精度损失
byte b1 = (byte)2000; // 数据溢出
```

**使用细节说明**

1. 强制转换符号只对于最近的操作数有效，往往会使用小括号提升优先级，例如：

   ```java
   int y = (int)(10*3.5+5*2.5);
   ```

2. `char`类型可以保存`int`的常量值，但是不能保存`int`的变量值，需要强制转换，例如：

   ```java
   char c1 = 100;
   int m = 100;
   char c2 = m; // 报错
   char c3 = (char)m; // 正常编译
   ```

### String类型转换

1. 基本数据类型转String类型

   基本数据类型的值 + "" 即可实现转换，例如`String s = 100 + ""`

2. String类型转基本数据类型

   通过基本类型的包装类调用`parseXX`方法即可实现转换，例如：

   ```java
   String s = "123";
   int num1 = Integer.parseInt(s);
   double num2 = Double.parseDouble(s);
   ```

   **把字符串转成字符char**：把字符串的第一个字符取出，例如：

   ```java
   char a = s.charAt(0)
   ```

**细节和注意事项**

1. 在将String类型转成基本数据类型时，要保证可以转换成有效的数据，例如把"hello"转换成整数就不可行。**编译正常**，但是执行时候会出问题。
2. 如果格式不正确，程序就会抛出异常`NumberFormatException`，可以进行异常处理

# 运算符

1. 算数运算符：没什么特别，唯一注意：++ 和 -- 的计算先后问题，和C语言相同

   程序中“+”的使用：如果左右<u>都是数值型</u>，做加法运算，如果左右两边<u>任意一方是字符串</u>，则做拼接运算。**注意**：做加法运算时是从左到右的顺序依次计算，从3、4两个例子之间的差别便可以看出这个规律。

   ```java
   System.out.println(100 + 98); //198
   System.out.println("100" + 98); //10098
   System.out.println(100 + 3 + "hello"); //103hello
   System.out.println("hello" + 100 + 3); //hello1003
   ```

2. 关系运算符：结果都是`boolean`类型，常用在`if`条件结构和循环结构中

   包含：==, !=, <, >, <=, >=, **instanceof**：检查是否是类的对象，例如`'aaa' instanceof String`

3. 逻辑运算符：用于连接多个条件（多个关系表达式），结果也是`boolean`类型，包含两大类：

   1. 短路与： &&；短路或：||；取反：！
   2. 逻辑与：&；    逻辑或：|；  **逻辑异或：^**

   短路运算符与逻辑运算符区别：如果使用短路运算符，若第一个条件便可以得到结果，则不会判断后面的条件，而逻辑运算符则会判断所有条件后才得到结果。因此短路运算符**效率高**，逻辑运算符效率低，<u>开发中通常使用短路运算符</u>

4. 赋值运算符：将运算后的值赋值给指定变量，例如+=, -=, %= ...

5. 三元运算符：基本语法：条件表达式 ? 表达式1: 表达式2；

   运算规则：如果条件表达式为True，返回表达式1的结果，否则返回表达式2的结果，本质就是一个简化版的if，例如：

   ```java
   int a = 10;
   int b = 99;
   int result = a>b ? a++:b--; // 返回10
   ```

6. 位运算：暂时略过

   ```java
   int a = 1>>2; //1向右位移2位
   int b = 3>>>3; //算数右移
   ```

# 控制结构

1. if-else 分支控制：基本语法：

   ```java
   if (expression1) {
       do;
   } else if (expression2) {
       do;
   } else {
       do;
   }
   ```

2. switch 分支控制：基本语法：

   ```java
   switch (expression) {
       case constant1:
           do;
           break;
       case constant2:
           do;
           break;
       default:
           do default;
           break;
   }
   ```

   **switch or if ?** -- 如果判断的具体数值不多，并且符合byte, short, int, char, enum, String这六种类型，建议使用`switch`，其他情况一般都使用`if`

3. for 循环控制：

   ```java
   for (int i=0; i<10; i++) {
       do;
   }
   ```

4. while 循环控制：

   ```java
   while (expression) {
       do;
   }
   ```

# 数组、排序和查找

## 数组的使用

1. 动态初始化

   数据类型[] 数组名 （或者 数据类型 数组名[]）= new 数据类型[大小]

   ```java
   int a[] = new int[5]; // 创建一个长度为5的整数型数组
   ```

2. 动态初始化

   先声明数组： `int a[];`，然后创建数组：`a = new int[10];`

3. 静态初始化

   语法：数据类型 数组名[] = {元素值1, 元素值2, ...}，用于预先知道元素值的情况，例如：

   ```java
   double hens[] = {3, 5, 2, 6.6, 9, 10}; // double[] 表示double类型的数组
   System.out.println(hens.length) // 输出数组的长度，6
   for (int i=0; i<hen.length; i++) {
       System.out.println(hen[i]);
   }
   ```

**使用注意事项**

1. 数组中的元素可以是任意数据类型，包括基本类型和引用类型，但是不可以混用
2. 数组创建后，如果没有赋值，数值类型默认值为0，char: \u0000, boolean: false, String: null
3. 数组属于引用类型，数组型数据是对象（object）
4. 数组`println`输出的结果是数组的地址

## 数组赋值机制

基本数据类型的赋值，赋值方式是值拷贝，赋值后的变量是独立存在，不会相互影响，例如：

```java
int n1 = 10;
int n2 = n1;
n2 = 80; // 这时n2=80, n1=10
```

数组在默认情况下是**引用传递**，赋的值是地址，例如：

```java
int arr1[] = {1, 2, 3};
int arr2[] = arr1; // arr2的变化会影响arr1
```

### 数组值拷贝

开辟新的数据空间，只传递数组的值而非地址：

```java
int arr1[] = {1, 2, 3};
int arr2[] = new int[arr1.length]; //开辟一块新的数据空间
arr2 = arr1;
```

### 数组翻转

1. 创建一个中间变量，用于保存提取出来的元素，将数组头尾元素依次交换，例如：

   ```java
   int temp = 0;
   int len = arr.length;
   for (int i = 0; i < len / 2; i++) {
       temp = arr[len-1-i];
       arr[len-1-i] = arr[i];
       arr[i] = temp;
   }
   ```

2. 创建一个新的数组，将元素依次取出并赋值给新的数组，最后<u>释放原来的数据空间</u>，例如：

   ```java
   int arr1[] = {1, 2, 3, 4, 5, 6};
   int arr2[] = new int[arr1.length];
   for (int i=arr1.length-1, j=0; i>=0; i--, j++) {
       arr2[j] = arr1[i];
   }
   arr1 = arr2; // 让arr1指向arr2的数据空间，原来的空间就**被释放了**
   ```

   因为原来的数据空间没有被变量引用，就会被当作垃圾销毁

### 数组扩容

要想向一个已经确定的数组`arr`中增加额外的元素，需要遵从以下的步骤：

1. 定义一个新的数据`int arrNew[] = new int[arr.length+1];`
2. 遍历原数组`arr`，依次将元素拷贝到`arrNew`数组
3. 将新的元素赋值给新的数组`arrNew[arrNew.length-1] = 4;`
4. 让`arr`指向`arrNew`：`arr = arrNew;`

**灵活输入扩容**：使用`Scanner`读取用户的输入，由用户决定是否停止扩容，<a href="../code/Arrayadd.java">参考代码 ArrayAdd.java</a>。













